<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/luckysheet/dist/plugins/css/pluginsCss.css' />
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/luckysheet/dist/plugins/plugins.css' />
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/luckysheet/dist/css/luckysheet.css' />
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/luckysheet/dist/assets/iconfont/iconfont.css' />
  <script src="https://cdn.jsdelivr.net/npm/luckysheet/dist/plugins/js/plugin.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/luckysheet/dist/luckysheet.umd.js"></script>
  <!-- <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script> -->
  <!-- <script src="./plugins/js/plugin.js"></script>
  <script src="./luckysheet.umd.js"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/luckyexcel/dist/luckyexcel.umd.js"></script>
  <!-- <script src="../node_modules/luckysheet/dist/plugins/js/plugin.js"></script>
  <script src="../node_modules/luckysheet/dist/luckysheet.umd.js"></script>
  <script src="../node_modules/luckyexcel/dist/luckyexcel.umd.js"></script> -->
  <title>honeycomb</title>
</head>

<body>

  <div id="root"></div>

</body>
<!-- <script src="../../honeycomb/node_modules/luckyexcel/dist/luckyexcel.umd.js"></script> -->
<script>
    $(function () {
        var name = "";
        while(name.length == 0){
            name = prompt("请输入昵称")
        }
        debugger;

        var autoSave;
        //配置项
        var options = {
            // functionButton: '<button id="" class="btn btn-primary" style="padding:3px 6px;font-size: 12px;margin-right: 10px;">下载</button> <button id="" class="btn btn-primary btn-danger" style=" padding:3px 6px; font-size: 12px; margin-right: 10px;">分享</button> <button id="luckysheet-share-btn-title" class="btn btn-primary btn-danger" style=" padding:3px 6px; font-size: 12px; margin-right: 10px;">秀数据</button>',
            // userInfo: name,
            // userName: name,
            lang: 'zh',
            container: 'luckysheet',
            allowUpdate: true,
            loadUrl:"http://localhost:9000/get",
            hook:{
                updated:function(e){
                    //监听更新,并在3s后自动保存
                    if(autoSave) clearTimeout(autoSave)
                    $(luckysheet_info_detail_save).text("已修改")
                    autoSave = setTimeout(function(){
                        var excel = luckysheet.getAllSheets();
                        //去除临时数据,减小体积
                        for(var i in excel) excel[i].data = undefined
                        $.post(
                            "http://localhost:9000/set",
                            {jsonExcel:JSON.stringify(excel)},
                            function(){
                                $(luckysheet_info_detail_save).text("已保存")
                            })
                    },3 * 1000)
                    return true;
                }
            },
            updateUrl: "ws://localhost:9000/ws?name=" + name
        }

        console.log(JSON.stringify(options))
        luckysheet.create(options)
    })
</script>

</html>